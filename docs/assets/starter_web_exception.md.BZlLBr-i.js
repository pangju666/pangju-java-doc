import{_ as l,c as s,o as e,ag as a}from"./chunks/framework.XA8aHGu3.js";const c=JSON.parse('{"title":"异常处理","description":"","frontmatter":{"layout":"doc"},"headers":[],"relativePath":"starter/web/exception.md","filePath":"starter/web/exception.md","lastUpdated":1764507457000}'),t={name:"starter/web/exception.md"};function n(E,i,d,p,h,o){return e(),s("div",null,[...i[0]||(i[0]=[a(`<h1 id="异常处理" tabindex="-1">异常处理 <a class="header-anchor" href="#异常处理" aria-label="Permalink to &quot;异常处理&quot;">​</a></h1><p>基于<code>ExceptionHandler</code>注解实现，涵盖了所有的常用异常。</p><p>所有异常的响应格式都为<code>Result</code>结构，响应示例如下：</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">错误码</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">错误信息</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="配置" tabindex="-1">配置 <a class="header-anchor" href="#配置" aria-label="Permalink to &quot;配置&quot;">​</a></h2><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">pangju</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  web</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    advice</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      enable-exception</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 启用全局异常处理器</span></span></code></pre></div><h2 id="业务异常" tabindex="-1">业务异常 <a class="header-anchor" href="#业务异常" aria-label="Permalink to &quot;业务异常&quot;">​</a></h2><p><a href="/pangju-java-doc/framework/web/exception.html"><code>BaseHttpException</code></a></p><ul><li>异常说明：业务异常/框架内置异常。</li><li>响应状态码：由<code>@HttpException</code>注解决定</li><li>记录日志：由<code>@HttpException</code>注解决定</li><li>响应信息：由异常的<code>message</code>决定</li></ul><h2 id="参数绑定与校验异常" tabindex="-1">参数绑定与校验异常 <a class="header-anchor" href="#参数绑定与校验异常" aria-label="Permalink to &quot;参数绑定与校验异常&quot;">​</a></h2><ol><li><code>MissingServletRequestParameterException</code><ul><li>异常说明：缺少请求参数异常。</li><li>响应状态码：400</li><li>记录日志：否</li><li>响应信息示例：缺少请求参数：username</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>MissingRequestHeaderException</code><ul><li>异常说明：缺少请求头异常。</li><li>响应状态码：400</li><li>记录日志：否</li><li>响应信息示例：缺少请求头：Authorization</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>MissingPathVariableException</code><ul><li>异常说明：缺少路径变量异常。</li><li>响应状态码：404</li><li>记录日志：否</li><li>响应信息示例：缺少路径变量：userId</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>MissingRequestValueException</code><ul><li>异常说明：缺少请求值异常。</li><li>响应状态码：400</li><li>记录日志：是</li><li>响应信息：缺少请求值</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>MissingServletRequestPartException</code><ul><li>异常说明：缺少请求文件异常。</li><li>响应状态码：400</li><li>记录日志：否</li><li>响应信息示例：缺少表单参数：username</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>MethodArgumentTypeMismatchException</code><ul><li>异常说明：方法参数类型不匹配异常。</li><li>响应状态码：400</li><li>记录日志：否</li><li>响应信息示例：参数：username类型不正确</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>TypeMismatchException</code><ul><li>异常说明：类型不匹配异常。</li><li>响应状态码：400</li><li>记录日志：是</li><li>响应信息：参数：username类型不正确</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>ServletRequestBindingException</code><ul><li>异常说明：请求参数绑定异常。</li><li>响应状态码：400</li><li>记录日志：是</li><li>响应信息：请求参数绑定错误</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>HttpMessageNotReadableException</code><ul><li>异常说明：请求内容不可读异常。</li><li>响应状态码：400</li><li>记录日志：是</li><li>响应信息：请求内容读取失败</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>MethodArgumentNotValidException</code><ul><li>异常说明：方法参数验证异常。</li><li>响应状态码：400</li><li>记录日志：否</li><li>响应信息示例：请求参数验证不合法/校验注解上的<code>message</code>列表，使用；分隔</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>BindException</code><ul><li>异常说明：表单绑定异常。</li><li>响应状态码：400</li><li>记录日志：否</li><li>响应信息示例：请求参数验证不合法/校验注解上的<code>message</code>列表，使用；分隔</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>MultipartException</code><ul><li>异常说明：文件上传失败异常。</li><li>响应状态码：400</li><li>记录日志：是</li><li>响应信息：文件上传失败</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>ConstraintViolationException</code>（如果存在这个类） <ul><li>异常说明：参数验证异常。</li><li>响应状态码：400</li><li>记录日志：是</li><li>响应信息：请求参数验证不合法/校验注解上的<code>message</code>列表，使用；分隔</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 2</li></ul></li><li><code>MaxUploadSizeExceededException</code><ul><li>异常说明：传文件大小超过限制异常。</li><li>响应状态码：400</li><li>记录日志：否</li><li>响应信息：上传文件大小超过100MB/上传文件大小超过限制</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>SizeLimitExceededException</code>（如果存在这个类） <ul><li>异常说明：Tomcat 的大小限制异常。</li><li>响应状态码：400</li><li>记录日志：否</li><li>响应信息：上传文件大小超过100MB</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 2</li></ul></li></ol><h2 id="路径与资源" tabindex="-1">路径与资源 <a class="header-anchor" href="#路径与资源" aria-label="Permalink to &quot;路径与资源&quot;">​</a></h2><ol><li><code>NoHandlerFoundException</code><ul><li>异常说明：请求路径不存在异常。</li><li>响应状态码：404</li><li>记录日志：否</li><li>响应信息示例：请求路径：/api/user 不存在</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>NoResourceFoundException</code><ul><li>异常说明：请求资源不存在异常。</li><li>响应状态码：404</li><li>记录日志：否</li><li>响应信息示例：请求资源：/api/user 不存在</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li></ol><h2 id="请求方法不支持" tabindex="-1">请求方法不支持 <a class="header-anchor" href="#请求方法不支持" aria-label="Permalink to &quot;请求方法不支持&quot;">​</a></h2><p><code>HttpRequestMethodNotSupportedException</code></p><ul><li>异常说明：请求方法不支持异常。</li><li>响应状态码：405</li><li>记录日志：否</li><li>响应信息示例：预期的请求方法类型：GET、POST</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul><h2 id="媒体类型不支持" tabindex="-1">媒体类型不支持 <a class="header-anchor" href="#媒体类型不支持" aria-label="Permalink to &quot;媒体类型不支持&quot;">​</a></h2><ol><li><code>HttpMediaTypeNotSupportedException</code><ul><li>异常说明：请求的<code>Content-Type</code>不支持异常。</li><li>响应状态码：415</li><li>记录日志：否</li><li>响应信息示例：预期的请求数据类型：application/json</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>HttpMediaTypeNotAcceptableException</code><ul><li>异常说明：<code>Accept</code>响应类型不支持异常。</li><li>响应状态码：406</li><li>记录日志：否</li><li>响应信息示例：预期的响应数据类型：application/json</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li></ol><h2 id="服务器错误" tabindex="-1">服务器错误 <a class="header-anchor" href="#服务器错误" aria-label="Permalink to &quot;服务器错误&quot;">​</a></h2><ol><li><code>HttpMessageNotWritableException</code><ul><li>异常说明：响应内容不可写异常。</li><li>响应状态码：500</li><li>记录日志：是</li><li>响应信息：响应内容写入失败</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>AsyncRequestTimeoutException</code><ul><li>异常说明：异步请求超时异常。</li><li>响应状态码：503</li><li>记录日志：是</li><li>响应信息：异步请求超时</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 3</li></ul></li><li><code>DataAccessException</code>（如果存在这个类） <ul><li>异常说明：数据访问异常。</li><li>响应状态码：500</li><li>记录日志：是</li><li>响应信息：数据访问错误</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 2</li></ul></li><li><code>NestedRuntimeException</code><ul><li>异常说明：嵌套运行时异常。</li><li>响应状态码：500</li><li>记录日志：是</li><li>响应信息：服务器内部错误</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 4</li></ul></li><li><code>Exception</code><ul><li>异常说明：所有未处理的异常（兜底处理）。</li><li>响应状态码：500</li><li>记录日志：是</li><li>响应信息：服务器内部错误</li><li>排序号：Ordered.HIGHEST_PRECEDENCE + 4</li></ul></li></ol><h2 id="自定义错误处理" tabindex="-1">自定义错误处理 <a class="header-anchor" href="#自定义错误处理" aria-label="Permalink to &quot;自定义错误处理&quot;">​</a></h2><p>如果想覆盖我的错误处理，需要让排序号比我定义的异常处理的排序号要更优先</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 需要排序号比我定义的更优先</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Order</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Ordered.HIGHEST_PRECEDENCE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Component</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RestControllerAdvice</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GlobalExceptionAdvice</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// @ResponseStatus(HttpStatus.BAD_REQUEST)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ExceptionHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MissingPathVariableException.class)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Result&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">handleMissingPathVariableException</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MissingPathVariableException </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fail</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;缺少路径变量：&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> e.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getVariableName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div>`,23)])])}const k=l(t,[["render",n]]);export{c as __pageData,k as default};
